---
title: "High-Protein Water-Efficient Foods."
author: "Stephen Franklin"
date: "May 2, 2015"
output:
  html_document:
    keep_md: yes
---

```{r libraries, echo=FALSE, message=F}
require(knitr)
library(data.table)
library(ggplot2)
library(jsonlite)
library(curl)
library(plyr)
library(rCharts)
library(psych)
library(gridExtra)
library(xtable)
#library(printr)
load("water_footprint_table.RData")
```

```{r setup, cache = F, echo = F, message = F, warning = F, tidy = F, eval=F}
# make this an external chunk that can be included in any file

#options(rcharts.mode = 'iframe', rcharts.cdn = TRUE) 
#knitr::opts_chunk$set(results = "asis", comment = NA)

options(width = 100)
require("knitr")
opts_chunk$set(message = F, error = F, warning = F, comment = NA, fig.align = 'center', dpi = 100, tidy = F, cache.path = '.cache/')
               ##, fig.path = 'fig_03_03/')
options(xtable.type = 'html')
knit_hooks$set(inline = function(x) {
  if(is.numeric(x)) {
    round(x, getOption('digits'))
  } else {
    paste(as.character(x), collapse = ', ')
  }
})
knit_hooks$set(plot = knitr:::hook_plot_html)
##setwd("~/git_folder/datascience/regmod/regression_models_notes/")
```


You've probably heard by now that there's a severe drought in California, and that governor Jerry Brown has ordered a 25% reduction in city water usage. You've probably also heard that 80% of California's water is used by agriculture, and that some crops, famously almonds, require a disproportionally large amount of water to grow, which is to say, they have a large water footprint.

Others have argued that the water footprint of almonds really isn't so bad compared to meat and to fodder crops for that meat. 

But do almonds or beef really have disproportionate water footprints if you consider the nutrition or energy they provide?

The Calorie is the unit of energy that we like to use for food, and as you would imagine, the more water a plant drinks, the bigger it gets, and the more calories it provides. The energy is used to grow mass, and besides water, there are three primary components of mass in both plants and animals: fats, carbohydrates, and proteins. 
There are of course vitamins and minerals and phytonutrients which are all very important but don't take up much of the mass.

So in one sense, the calorie is a good summary measure of how useful a food is to you. All else being equal, it would be more efficient to eat something higher in calories. That something would probably be pure glucose, or as a close second, high fructose corn syrup. The point is that there is no short supply of cheap calories in most of the world. The same pretty much goes for fats and for carbohydrates. Let's look for another measure of nutrition. My favorite is protein.

If we can measure the water footprint of foods controlling for their protein content, then we can get a good idea of what really is or isn't an efficient use of agricultural water for the stuff we eat.

The studies we have of water footprints (as well as the concept itself) come from mostly one place, the UNESCO-IHE Institute for Water Education in the Netherlands. I've paired down their studies to 48 plant sourced foods (38 in California) and 13 animal sourced foods. Then I cross-referenced their nutrition data from the USDA National Nutrient Database.

UNESCO-IHE measure three water footprints actually. The *blue water footprint* refers to the ground water used to produce a product, the *green water footprint* refers to the rain water used, and the *grey water footprint* is the volume of water that is required to dilute all of a product's pollutants (fertilizers, pesticides, manure, etc.) to such an extent that the quality of the water remains at or above legal standards. I used just one total water footprint, the sum of those three.

The water footprint of a food strongly correlates positively with its protein content. What is also interesting is that, controlling for protein, animal sourced foods, have about the same water footprint as plant sourced foods. 

So yes, meats and nuts have amazingly high water footprints, and beef and almonds are that the top. In California, beef takes 75 liters of water for each gram of protein it has. At 21% protein that's 1,575 liters of water for just 100 grams of raw beef. (That's 400 gallons for just 3.5 ounces.) Almonds, also 21% protein, are almost as thirsty, requiring 62 liters per gram of protein -- 1,300 liters for 100 grams of almonds. Even less water efficient are walnuts, garbanzo beans, and hazelnuts. Hazelnuts require 115 liters of water for each gram of protein they provide.

Despite the strong trend of higher protein foods having higher water footprints, we can still find high protein foods that buck the trend and are unusually efficient in their water use.

Here's two lists of foods with a protein content of at least 10%, one for California grown foods, and one from a Global average.  

<table style="width:100%";>
<tr><td>
```{r table_protein_CA_10, echo=F, eval=T, results='asis'}
require(xtable)
setkey(water, CA_L_per_g_protein)
CA_adjfp_prot_10 <- xtable(na.omit( water[protein>10,.( Products, L_per_g_Protein=round(CA_L_per_g_protein), "% protein"=round(protein) )] ),align=c('c','c','c','c'))
kable(CA_adjfp_prot_10, format = "html", caption = "Protein Adjusted Water Footprint of Foods > 10 g Protein (in California)")
```
</td>
<td>
```{r table_protein_global_10, echo=F, eval=T}
require(xtable)
setkey(water, G_L_per_g_protein)
Gl_adjfp_prot_10 <- xtable(water[protein>10,.( Products, L_per_g_Protein=round(G_L_per_g_protein), "% protein"=round(protein) )], align=c('c','c','c','c'))
kable(Gl_adjfp_prot_10, format = "html", caption = "Protein Adjusted Water Footprint of Foods > 10 g Protein (Globally)")
```
</td></tr>
</table>
  
I've ordered it by the second column, which shows the amount of water (in Liters) used to produce just one gram of protein in that food. The third column shows the percent of protein by mass that that food contains. We want the food that uses the least water to produce its protein. And if we don't want to eat lots of food to get our protein, then we want the food that has the highest percentage of protein as well. 

Globally, that would be the Brazil Nut, which is definitely an outlier. The water footprint of 2 Liters per gram protein is so low that it seems suspicious. If it is correct, it could be because Brazil Nuts are unique in that they are gathered from existing trees rather than from plantations. Perhaps the existing infrastructure of old trees means that ground water needn't be diverted to grow a tree first. Of course if everyone started eating tons of Brazil Nuts than they'd have to start growing more trees and presumedly those trees would have a high water footprint.

A couple of caveats about this data. The water footprint is calculated for raw foods. Raw meat has more fat and water than cooked meat, and therefore has less protein by mass. Raw lentils and beans are dry and have much more protein by mass than when they are actually edible. (I think the extra few liters it takes to clean and cook the beans is negligable though.) As you may know, there are many different proteins made from combinations of amino acids, nine of which our bodies can't make. We call those nine the essential amino acids, and foods that have those nine are said to have a complete protein. Monocots (like rice and corn) and dicots (like beans and lentils) complement each other's amino acids to form a complete protein. (By the way, your cells store them up, so you don't even have to eat them at the same meal!) The advantage of animal sourced food is that it always has complete proteins. Some plants do too though -- quinoa is famous for that. But nevermind that, I'm not counting the completeness of proteins here, just the overall quantity.

The big advantage of high protein foods (meats and nuts) is that we can eat a lot less of them, which makes life easier. For example, if you eat just 100 grams (3.5 ounces) of turkey, you'll get 20 grams of protein. To get 20 grams of protein from spinach, you would need to eat a kilogram (2.2 pounds). But the water footprint of a kilogram of spinach (160 L) is still less than that of 100 grams of turkey (220 L) -- 60 Liters less. It's sounds like an enourmous amount of spinach to eat in one sitting, but not unreasonably so. In fact, there are vegan athletes who do eat these enourmous quantities of fruits and vegetables.

In Mekonnen and Hoekstra's 2012 report, __The Green, Blue and Grey Water Footprint of Farm Animals and Animal Products__, they provide their own table of water fooprints versus protein:

![Mekonnen's report gives meat an unusually low proportion of protein.](./mekonnen_2012_table3.png)

<!--
<iframe src="./mekonnen_2012_table3.small.html" width="100%" frameborder= "0" class="myIframe">
<p>http://waterfootprint.org/media/downloads/Mekonnen-Hoekstra-2012-WaterFootprintFarmAnimalProducts.pdf</p>
</iframe>

<script type="text/javascript" language="javascript"> 
$('.myIframe').css('height', $(window).height()*0.6+'px');
</script>
-->   
   
But their levels of protein seem unusually low.

The proportion of protein that I used, I obtained by selecting just the raw products from the USDA list, and then taking their median. The median seems more approptiate than the mean, as the mean gets dragged around more by outliers. It turns out that with the food data, both measures of average are similar.

Choosing only raw foods seemed reasonable because the water footprint calculations don't mention anything as cooked. Calculating the water footprints for cooked or cured foods would seems unnecessarily complicated and useless. The USDA nutrition numbers for cooked (or otherwise prepared) foods have a much higher variance. The raw value has its own bias of course. Primarily, legumes (or pulses) which must be soaked to be eaten have a much higher proportion of protein when dry. Cooked meats have much higher protein levels than raw meats because much of the water and fat is evaporated.

Here is a comparison of measures of average of the protein content of beef:

beef protein averages (%) | raw      | cooked or raw   
--------------------------|----------|--------
median                    | 20.69    | 24.24 
mean                      | 19.97    | 24.37

The Mekonnen-Hoeksta report lists a value of 138 g/kg (or 13.8%) of protein for beef, which seems low compared to the USDA analysis. The difference in protein naturally results in a different estimate of the water footprint per protein (since the water footprint part of the estimate that I use is from their data).

**Comparison of Water/Protein Rates (L/g protein)**

Product     | Franklin  | Mekonnen
------------|-----------|------------------
Beans       |  24       |  19
Chicken     |  24       |  34
Lentils     |  25       |  19
Eggs        |  25       |  29
Milk        |  30       |  31
Pork        |  30       |  57
Pistachio   |  56       | 139
Beef        |  75       | 112
Almonds     |  76       | 139
Butter      | 274       |   0

Despite the differences, their general conclusion that animal sourced food has a much higher water footprint holds true. Though nuts have equally high water footprints, we consume ten times more meat and dairy, so the overall water footprint just dwarfs that of nuts. 

Will avoiding foods that have a high water footprint (meat and nuts) meaningfully affect California's agricultural water use?  

![The water footprint of alfalfa and animal feed is huge. http://pacinst.org/wp-content/uploads/sites/21/2013/02/ca_ftprint_full_report3.pdf](./fig7_Californias_water_footprint_fulton_2012.png)

In 2013, California produced about 900 million kilograms (2 billion pounds of almonds) using about 2.63 billion cubic meters (2.13 million acre feet) of water (not counting grey water). That is about the same volume as Mount Everest. Two thirds of those almonds were exported (USDA CA) (Pacinst). If Americans stopped eating almonds, we can assume that would have some effect economically. Perhaps the price would drop. Perhaps that 33% domestic portion of almonds would be exported as well. Or perhaps production would be reduced.

If production of almonds for domestic use was reduced to zero for a year, that would save about 876 million cubic meters of water, which is something. It would be enough to refill California's second largest resevoir, Lake Oroville, to a normal level (water.ca.gov). In comparison, the mandatory water reduction in Californian cities amount to a savings of 1.85 billion cubic meters (1.5 million acre feet) over nine months (water.ca.gov). So less almond eating could arguably help.

Animal products are actually a much, much bigger contributer to California's water footprint. California's production of "animal feed" as well as "Alfalfa, Straw, and Hay" (which is used as roughage in animal feed but counted separately because of a difference in imports/exports) account for about 26 billion cubic meters (21 million acre feet) of water (not counting grey water) or ten Mount Everests of water (pacinst).

About 1.6 billion cubic meters (1.3 million AF) of meat and dairy products and 1.2 billion cubic meters (1 million AF) of alfalfa, straw, and hay are exported internationally (pacinst). California is actually an importer of animal feed. Apparently that enormous water footprint represents *not enough* animal feed (pacinst 18). There is a huge amount of Californian meat and dairy products that are exported and imported, both nationally and internationally, so it's less easy to estimate the possible amount of water that would be saved by refraining from meat. Suffice to say, it's hard to look at those plots and not think about taking an extra long shower instead of eating a burger. As an omnivore, it just got a lot harder to mock the vegans.


****

<!--

They state: "When we look at the water requirements for protein,
we find that the water footprint per gram of
protein for milk, eggs and chicken meat is about 1.5
times larger than for pulses. For beef, the water
footprint per gram of protein is 6 times larger than
for pulses."

"The general conclusion is that from a freshwater resource
perspective, it is more efficient to obtain calories,
protein and fat through crop products than animal
products."

"Meat-based diets have a larger water footprint
compared to a vegetarian diet. We explored the
implications of our results by examining the diet
within one developed country—the USA—to
determine the effect of diet composition on water
footprint. Meat contributes 37% towards the foodrelated
water footprint of an average American
citizen. Replacing all meat by an equivalent
amount of crop products such as pulses and nuts
will result in a 30% reduction of the food-related
water footprint of the average American citizen."

While is seems obvious that animal sourced foods are increasingly unsustainable for many other reasons (land needs, deforestation, increasing atmospheric methane, antibiotic resistance), from a water perspective, both meats and nuts make for a high water footprint.


1 million acre-feet is $1.233 \times 10^9 m^3$ (1.2 billion cubic meters or 1.2 cubic kilometers) and is also half the volume of Mount Everest.

-->

Correlations

```{r pairs, echo=F, comment=F, warning=F, error=F, eval=F}
require(psych)
svg(file="water_pairs.svg", width = 8)
par(mfrow = c(1,1))
pairs.panels( water[,c(3:8),with=F], smooth=T, ellipses=F, cor=T,
      main = "Water Footprint Correlations: Global Average", pch=21, 
      bg = 2 + (as.numeric(water$kingdom) < 2)) ## color: red=2,green=3, plant=1,animal=2
dev.off()
```
![Exploratory pairs plot for water footprints.](./water_pairs.svg)


# Footprint vs. Protein

```{r plot_pro_v_foot, echo=F, results='asis', fig.height=6, fig.width=8, eval=F}
### protein vs global_avg_footprint
### NON-interactive
w1 <- ggplot(data=water, aes(y = Global_avg_footprint, x = protein, color=kingdom)) +   
        geom_point(data = subset(water, protein <= 3 & Global_avg_footprint < 3000)) 
w1 <- w1 + scale_color_manual(breaks = c("plant", "animal"), 
                              values=c("darkred", "green4"),
                              name= "Source")
w1 <- w1 + geom_smooth(data = water, method="lm", fullrange=TRUE)
w1 <- w1 + geom_text(aes(label=ifelse(
                                protein > 3 | 
                                Global_avg_footprint > 3000, 
                                Products,'')), 
                     hjust=0,just=0, size=3,
                     position = position_jitter(w = 0.5, h = 300),
                     show_guide = F)
w1 <- w1 + labs(y=expression("Water Footprint: Global Average ("*m^3/ton*")"), x = "Protein (%)", title="Water Footprint vs. Protein of Raw Foods: Global Average")
w1 <- w1 + theme(axis.title=element_text(face="bold.italic", 
   color="brown"), legend.position="top")
w1 <- w1 + expand_limits(y = c(0, 17500), x = c(0, 30) )
ggsave("prot_Global.svg", width=8)
```
![The water footprint is positively correlated with protein content.](./prot_Global.svg)
<!--![The water footprint is positively correlated with protein content.](./prot_Global1.svg)-->

# Footprint vs. Protein: Global Average (Interactive)
```{r interactive, echo = FALSE, fig.path="", results = "asis", comment=NA}
require(rCharts)
w2 <- nPlot(Global_avg_footprint ~ protein, 
            group = 'kingdom',  name = 'Source',
            data = water, 
            type = 'scatterChart')
w2$chart(color = c("green", "darkred")) 
w2$chart(tooltipContent =   "#! function(key, x, y, e){ 
                                return e.point.Products
                            } !#")
w2$set(title = "Water Footprint vs. Protein: Global Average")
w2$xAxis(axisLabel = 'Protein (%)')
w2$yAxis(axisLabel = "Water Footprint: Global Average (m^3/ton)" )
w2$chart(showControls = F)  ## turn off stupid magnify.
w2                                  ## RStudio; not Shiny-server
#w2$show('iframe', cdn = TRUE)      ## RStudio; not Shiny-server
#w2$show('iframesrc', cdn = TRUE)   ## not RStudio; shiny-server
```


# Footprint vs. Protein: California
```{r plot_pro_v_foot_CA, comment=F, echo=F, results='asis', fig.height=6, fig.width=8, eval=F}
### protein vs global_avg_footprint
### NON-interactive
w1 <- ggplot(data=na.omit(water), aes(y = California_footprint, x = protein, color=kingdom)) +   
        geom_point(data = subset(na.omit(water), protein <= 3 & California_footprint < 3000, na.omit=T)) 
w1 <- w1 + scale_color_manual(breaks = c("plant", "animal"), 
                              values=c("darkred", "green4"),
                              name= "Source")
w1 <- w1 + geom_smooth(data = na.omit(water), method="lm", fullrange=TRUE)
w1 <- w1 + geom_text(aes(label=ifelse(
                                protein > 3 | 
                                California_footprint > 3000, 
                                Products,'')), 
                     hjust=0,just=0, size=3,
                     position = position_jitter(w = 0.5, h = 300),
                     show_guide = F)
w1 <- w1 + labs(y=expression("Water Footprint: California ("*m^3/ton*")"), x = "Protein (%)", title="Water Footprint vs. Protein of Raw Foods in California")
w1 <- w1 + theme(axis.title=element_text(face="bold.italic", 
   color="brown"), legend.position="top")
w1 <- w1 + expand_limits(y = c(0, 17500), x = c(0, 30) )
ggsave("prot_US_CA.svg", width=8)
```
![The water footprint is positively correlated with protein content.](./prot_US_CA.svg)   

# Footprint vs. Protein: California (Interactive)
```{r interactive_CA, echo = FALSE, fig.path="", results = "asis", comment=NA}
require(rCharts)
w2 <- nPlot(California_footprint ~ protein, 
            group = 'kingdom',  name = 'Source',
            data = na.omit(water), 
            type = 'scatterChart')
w2$chart(color = c("green", "darkred")) 
w2$chart(tooltipContent =   "#! function(key, x, y, e){ 
                                return e.point.Products
                            } !#")
w2$set(title = "Water Footprint vs. Protein: California")
w2$xAxis(axisLabel = 'Protein (%)')
w2$yAxis(axisLabel = "Water Footprint: California (m^3/ton)" )
w2$chart(showControls = F)  ## turn off stupid magnify.
#w2                                 ## works in RStudio
w2$show('iframe', cdn = TRUE)       ## works in RStudio
#w2$show('iframesrc', cdn = TRUE)   ## works in shiny-server
```

# Adjusting the Water Footprint for Protein

<style>
table, th, td {
    border: 1px;
    padding: 4px;
    text-align: center;
}
table {
    border-spacing: 25px;
}
</style>
<table style="width:100%";>
<caption>Water Efficient Foods</caption>
<tr>
<th>California</th>
<th>Global Average</th>
</tr>
<tr><td>
```{r table_protein_CA, echo=F, eval=T, results='asis'}
require(xtable)
setkey(water, CA_L_per_g_protein)
CA_adjfp_prot_low <- xtable(head( na.omit(water[,.( Products, L_per_g_Protein=round(CA_L_per_g_protein), "% protein"=round(protein) )]),10 ),align=c('c','c','c','c'))
kable(CA_adjfp_prot_low, format = "html", caption = "Water Efficient Foods (California)")
```
</td>
<td>
```{r table_protein_global, echo=F, eval=T}
require(xtable)
setkey(water, G_L_per_g_protein)
Gl_adjfp_prot_low <- xtable(water[1:10,.( Products, L_per_g_Protein=round(G_L_per_g_protein), "% protein"=round(protein) )],align=c('c','c','c','c'))
kable(Gl_adjfp_prot_low, format = "html", caption = "Water Efficient Foods (Global Average)")
```
</td></tr>
</table>

*****


# Comparison of Water Footprints: California vs. Global Average 
```{r diffs, echo=F, eval=F}
differences <- na.omit((water[, .(Products, 
                         difference=(California_footprint-Global_avg_footprint),
                         California_footprint, Global_avg_footprint)]))
differences$abs=abs(differences$difference)
setkey(differences,abs)
differences <- differences[order(-abs)]
head(differences,15)
nrow(differences)

library(reshape2)
diff.long<-melt(head(differences,10), id=c("Products","difference"), measure=c("California_footprint","Global_avg_footprint"))

d1 <- ggplot(diff.long, aes(x=reorder(Products,-difference),value,fill=variable)) +
geom_bar(stat="identity",position="dodge")
d1 <- d1 + labs(y=expression("Water Footprint ("*m^3/ton*")"), x = "", title="Comparison of 10 Differing Water Footprints: California vs. Global Average")
d1 <- d1 + theme(axis.title=element_text(face="bold.italic", 
   color="brown"), legend.position="top")
d1 + guides(fill = guide_legend(title = NULL))


#ggplot(diff.long, aes(x=reorder(Products,-difference),value,fill=variable))+
#geom_bar(stat="identity",position="dodge") +
#coord_flip() + geom_text(aes(x=reorder(Products,-difference), `value`, label = sprintf("%2.0f", `value`), y=(`value`)*1.02+900, ymax=max(`value`)*1.05), position = position_dodge(width=1))
ggsave("differences.svg", width=8)
```
![Some foods in California have widely different water footprints.](./differences.svg)


****

<!--

When I refer to raw foods, I'm not talking about the Raw Food movement, but to literally raw foods. Raw meat has more fat and water than cooked meat, and therefore has less protein by mass. Raw lentils and beans are dry and have much more protein by mass than when they are actually edible.

Discuss how we've heard that almonds are water intensive crops. And that meat even moreso.

barplot CA water footprint 10 highest.

Discuss how animal-based food does appear to be very water intensive, but not exclusively so.

Discuss where this data comes from, and how they are missing alfalfa (even though people do eat alfalfa) and other fodder crops (hay). Show quote where the researchers explain that they're including fodder in their meat estimates.

****

"The water footprint of a live animal consists of
different components: the indirect water footprint
of the feed and the direct water footprint related to
the drinking water and service water consumed. . . The water footprint of an animal related to the
feed consumed consists of two parts: the water
footprint of the various feed ingredients and the
water that is used to mix the feed."

http://waterfootprint.org/media/downloads/Mekonnen-Hoekstra-2012-WaterFootprintFarmAnimalProducts.pdf pp2-3 (pp402-3 as labeled) 

*****
Total outputs of CAlifornia


In 2013, California produced approximately
7.96 million tons of alfalfa hay, valued at
$1.57 billion. --http://www.nass.usda.gov/Statistics_by_State/California/Publications/California_Ag_Statistics/CAFieldCrops.pdf page 13

****
2013: top CA commodities
Milk and Cream  7,617,641,000  almost 21 percent of the nation's milk supply. Asian markets imported 53 percent of US dairy exports in 2013
Almonds         5,768,100,000    99% of the nation
Grapes          5,585,584,000    leads the nation
Cattle & Calves 3,048,390,000    
meat animal     3,088,751,000

milk and cream      41,256,000,000 *lbs*    $7,617,641,000  1
almonds (shelled)   1,005,000 short tons    $5,768,100,000
grapes              7,717,000 sh.tons       $5,585,584,000
cattle & calves     2,039,468,000 *lbs*     $3,048,390,000
Strawberries        1,378,000 sh.tons       $2,200,729,000
Walnuts             492,000 sh.tons         $1,795,800,000
Lettuce             2,987.70 sh.tons        $1,679,164,000
hay, alfalfa, etc   7,956,000  sh.tons      $1,569,780,000  8
tomatoes            12,520,000 sh.tons      $1,222,470,000  9
...
corn for silage     10,998,000 sh.tons      $530,434,000
corn for grain      962,640 sh.tons         $183,245,000
beans, dry          1,150,000 cwt           $65,320,000
(cwt is hundredweight: 100 lbs)

add others, depending on their low footprint/protein.

http://www.nass.usda.gov/Statistics_by_State/California/Publications/California_Ag_Statistics/CA_Ag_Overview.pdf

****
general source for CA 2013 yields: 
http://www.nass.usda.gov/Statistics_by_State/California/Publications/California_Ag_Statistics/index.asp
****

We could show how CA is more efficient than the global average on almonds and less efficient on other crops.

plot of greatest (non-absolute) difference of water footprint between CA and Global average on some sort of centered bar plot where the bar extends out left/right from the center.
 
****

scatterplot CA protein vs water footprint with labels or text.

interactive version of the same.

******
harvested roughages: include those which are sown and harvested annually for forage, fodder or silage. The principal types of
harvest roughages include forage (green) cereals such as maize, oats and sweet sorghum; sugarcane, lucerne (alfalfa) and berseem
(Egyptian clover); special high yielding grasses cultivated chiefly for silage (such as Thimoth grass); roots and tubers such as
potatoes, beets, swedes, turnips; oilseeds such as winter rape; pulses such as field peas, beans, sweet lupins and vetches;
vegetables such as pumpkins and cabbages. These feeds are sometimes processed for lower fibre content and bulk and are then
usually classified as concentrate feeds (e.g. cassava chips and pellets, processed alfalfa, pea and bean meals).  (p14)

The total feed consumption
over the period 1996-2005 was 4996 million ton feed in dry matter per year, on average. Roughages account for
the largest share out of this total, accounting for 80%, and feeds derived from crop production account for the
remaining 20%.  (p20)

http://waterfootprint.org/media/downloads/Report-48-WaterFootprint-AnimalProducts-Vol1.pdf

*****



*****

#### Conversions:
#### 1000 cubic meters / metric ton
#### = 120 gallons / pound
#### = 26.4 gallons / 100 grams  
#### ~or~ 4000 m3/t = 100 gal / 100 g

## 1/2 lb hamburger: 14000 m3/t = 14*120/2 = 840 gallons
## 1/2 lb almonds:   13000 m3/t = 13*120/2 = 780 gallons

### Conversion factors ###

# cf.m3_t.L_100g    <- 0.1      ## cubic meters per metric ton to Liters per 100 grams.
# cf.m3_t.gal_100g  <- .026     ## m^3 per m.ton to US liquid gallons per 100 grams. 
# cf.m3_t.gal_oz    <- .007489  ## m^3/m.ton to US liq gallons per avoirdupois ounces.



#### Animal data -- import data ####

## Each country column comprises four columns for four Production systems:
## Grazing    Mixed    Industrial	Weighted average.
## We want just the weighted averages 
## for the United States and the World Average.

## There's some non-food products which we should eliminate, 
##          e.g. Semen bovine 1064393    1142704.
animal_cg[,food:=logical(.N)]
## Some key words for non-food / food are:
## live, waste, semen, hair, skin, hide, bend, leather
## carcass, cut, meat, edible, fresh, frozen, prepar, preserv, process, dried

# Products
# 1:  Milk not concentrated & unsweetened exceeding 1% not exceeding 6% fat
# 2: Yogurt concentratd o not,sweetend o not,flavourd o contg fruit o cocoa
# 3:                                           Milk and cream nes sweetened
# 4:                       Eggs, bird, in shell, fresh, preserved or cooked
# 5: Dom fowl,duck,goose&guinea fowl meat&meat offal prep/presvd exc livers
# 6:                                                             Cheese nes
# 7:                                    Goat meat, fresh, chilled or frozen
# 8:                                                                 Butter
# 9:                                      Swine cuts, fresh or chilled, nes
# 10:                                 Sheep cuts, boneless, fresh or chilled
# 11:                                 Bovine cuts boneless, fresh or chilled

##!! Notes:
## I chose the meats that were described as fresh and boneless.
## Excluded meats that were offal, liver, or preserved.
## Excluded animal_ed[65] as an outlier, though a remarkable one.
##  Horse, ass, mule or hinny meat, fresh, chilled or frozen    47317    51779
##  Bovine meat cured    21909	23799
## Also: why no fish?

##!! Initial observation is that high protein products use the most water.


#quantile(animal_s$mass)
    ### The mass should be close to 100,
    ### as the nutrients are measured in grams per 100 grams of product.

### USDA plant data ####
## These plants aren't *easily* grepped in a function,
## mostly because the study's names are not similar to the USDA's names.
## e.g. "aubergines(egg-plants)" vs. "eggplants"
## Or because the products themselves weren't easy to match.
## e.g. sugar, coffee, cocoa, and tea are all plants;
## the USDA lists them as many diverse products, but not as raw plants.
## *!*!* Also, what does "nes" mean? ... I'm going with "not explicitly stated".

## ... that was kind of a waste of effort for only 9 extra observations; that's what I get for trying to be overly inclusive.


models!



    




#### Tables and plots ####

setkey(water,protein)
rm(California_footprint, Global_avg_footprint, Products, protein)

qplot(data=water, x=water$California_footprint,y=water$protein,
      color = water$kingdom)
qplot(data=water, x=water$Global_avg_footprint,y=water$protein,
      col = water$kingdom)


par(mfrow = c(1,1))
pairs(water[,c(2,3,4,5,8,9),with=F], panel = panel.smooth, 
      main = "water footprint data", 
      col = 2 + (as.numeric(water$kingdom) < 2)) ## color: red=2,green=3, plant=1,animal=2
cor(water$protein,water$California_footprint)

wfit0 <- lm(Global_avg_footprint ~ protein, water)
summary(wfit0)$r.squared
summary(wfit0)$coefficients

### Global_avg: We would expect a 390 m3/ton increase in the footprint for each 1 gram increase in protein.
### The amount of protein in the food explains 61% of the variance in the data.
### This makes sense because protein synthesis requires water.
### https://www.youtube.com/watch?v=H8WJ2KENlK0&index=3&list=PL3EED4C1D684D3ADF
### https://www.youtube.com/watch?v=itsb2SqR-R0&index=11&list=PL3EED4C1D684D3ADF
### CA: 450 m3/ton increase. r2 is 52%.

### Do animal-based foods have a bigger water footprint than plant-based foods?
wfit1 <- lm(Global_avg_footprint ~ as.numeric(kingdom), water)
summary(wfit1)$r.squared
summary(wfit1)$coefficients
### Well, it seems (p-value = 0.01) 
### there is a somewhat significant increase in the water footprint of 
### animal-based foods over plant-based foods.
### But it only explains 13% of the variance.

### Holding protein constant:
wfit2 <- lm(Global_avg_footprint ~ kingdom + protein, water)
summary(wfit2)$r.squared
summary(wfit2)$coefficients
### It seems protein content is very important in predicting water footprint.

## Examining the interaction between kingdom and protein
wfit3 <- lm(Global_avg_footprint ~ protein * kingdom, water)
summary(wfit3)$r.squared
summary(wfit3)$coefficients
### The reference category for `kingdom` is "1" -- plants, 
### which has and intercept of 155 m3/ton. 
### The slope for *animals* is 416. 
### The change in intercept for *animals* is 1685.
### And the change in slope for *animals* is -125.

### The interaction isn't significant (p: 0.3 > 0.05)

### Let's plot the regression lines for animal versus plant sources,
### with protein as an interaction:
par(mfrow = c(1,1))
plot(protein,Global_avg_footprint,pch=19)
points(protein,Global_avg_footprint,pch=19,col=((as.numeric(kingdom)<2)*1+2))
## Again, the as.numeric() turns the factor "0" into a 1
## and the factor "1" into a 2.
abline(c(wfit3$coeff[1],wfit3$coeff[2]),col="green",lwd=3)
abline(c(wfit3$coeff[1] + wfit3$coeff[3],wfit3$coeff[2] +wfit3$coeff[4]),col="red",lwd=3)
### The two food sources seem closely correlated, and that agrees
### with the interaction being insignificant.

### But let's check the residuals
par(mfrow = c(1,1))
ew <- wfit3$residuals 
plot(kingdom, ew,
     xlab = "kingdom (0=plant)",
     ylab = "Residuals")

### compared to fit2
par(mfrow = c(1,1))
ew <- wfit2$residuals 
plot(kingdom, ew,
     xlab = "kingdom (0=plant)",
     ylab = "Residuals")
### Very similar. Lots of outliers in plants.

## resdiuals and leverage
par(mfrow = c(2, 2))
plot(wfit3)
### Three products -- beef, butter, almonds -- have significant leverage in the model. 

### Let's see the model without them:
par(mfrow = c(1,1))
plot(protein[c(-12,-45,-46)],Global_avg_footprint[c(-12,-45,-46)],pch=19)
points(protein[c(-12,-45,-46)],Global_avg_footprint[c(-12,-45,-46)],pch=19,col=((as.numeric(kingdom[c(-12,-45,-46)])<2)*1+2))
abline(c(wfit3$coeff[1],wfit3$coeff[2]),col="green",lwd=3)
abline(c(wfit3$coeff[1] + wfit3$coeff[3],wfit3$coeff[2] +wfit3$coeff[4]),col="red",lwd=3)
### Pretty much the same.

### Analysis of variance to compare the three models:
anova(wfit0, wfit1, wfit2, wfit3)
#### anova shows that wfit2 
#### (predicting the footprint by kingdom holding protein constant)
#### is the best model.

###  
library(MASS)
wfit.s <- stepAIC(lm(Global_avg_footprint ~ ., data = water[,c(3,4,5),with=F]), trace = 0) 
summary(fit.s)$coeff




#### The USDA numbers and descriptions of foods are different
#### than the water footprint data.

### e.g. USDA doesn't have "bovine", and a search for "beef"
### yields 1154 results with a variety of protein content.
### "beef ground" yield 49 choices.
### Perhaps the best choice is: 
### "name": "Beef, ground, unspecified fat content, cooked",
### "ndbno": "23220"  (about 25 g protein)
### But "beef chuck" which yields 179 choices of higher protein values (up to 36 g).

-->

# References

http://waterfootprint.org/en/resources/water-footprint-statistics/

http://www.ars.usda.gov/research/projects/projects.htm?accn_no=426560

http://www.ars.usda.gov/sp2UserFiles/Place/80400525/Data/SR27/sr27_doc.pdf

USDA CA, California Agricultural Statistics 2013 Crop Year, 2015, http://www.nass.usda.gov/Statistics_by_State/California/Publications/California_Ag_Statistics/CAFruitsandNuts.pdf

Pacinst, Fulton, Julian et al., 2012, http://pacinst.org/wp-content/uploads/sites/21/2013/02/ca_ftprint_full_report3.pdf

water.ca.gov, 2015, http://www.water.ca.gov/waterconditions/waterconditions.cfm

http://waterfootprint.org/media/downloads/Report-48-WaterFootprint-AnimalProducts-Vol1.pdf


****


This work is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License. To view a copy of this license, visit http://creativecommons.org/licenses/by-sa/4.0/.

<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Dataset" property="dct:title" rel="dct:type">water_footprint.R</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http:\\stephenfranklin.info" property="cc:attributionName" rel="cc:attributionURL">Stephen Franklin</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="http://waterfootprint.org/en/resources/water-footprint-statistics/" rel="dct:source">http://waterfootprint.org/en/resources/water-footprint-statistics/</a>.<br />Permissions beyond the scope of this license may be available at <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.ars.usda.gov/Services/docs.htm?docid=8964" rel="cc:morePermissions">http://www.ars.usda.gov/Services/docs.htm?docid=8964</a>.
